<!DOCTYPE html>
<html lang="vi">
<head>
    <%- include('../partials/head', { title: post.title }) %>
    <style>
        .breadcrumb { padding: 15px 0; border-bottom: 1px solid #eee; margin-bottom: 30px; font-size: 0.9rem; }
        .breadcrumb a { color: var(--primary); }
        .post-content img { max-width: 100%; height: auto; margin: 15px 0; }
        .comment-section { background: #f9f9f9; padding: 30px; border-radius: 8px; margin-top: 50px; }
        .comment-item { background: white; padding: 15px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid var(--secondary); }
    </style>
</head>
<body>
    <%- include('../partials/header') %>

    <div class="container section-padding">
        <div class="breadcrumb">
            <a href="/">Trang chủ</a> <span>></span> 
            <a href="/tin-tuc">Tin tức</a> <span>></span> 
            <span style="color: #777;"><%= post.title %></span>
        </div>

        <article>
            <h1 style="color: var(--primary); margin-bottom: 10px;"><%= post.title %></h1>
            <p style="color: #888; margin-bottom: 20px;">
                <i class="far fa-calendar-alt"></i> Đăng ngày: <%= new Date(post.publish_date).toLocaleDateString('vi-VN') %>
            </p>

            <div class="post-thumbnail mb-3">
                <img src="<%= post.thumbnail_url %>" 
                     alt="<%= post.title %>" 
                     style="width: 100%; max-height: 500px; object-fit: cover; border-radius: 8px;"
                     onerror="this.src='/img/placeholder/post-default.jpg'">
            </div>

            <div class="post-content">
                <%- post.content %>
            </div>
        </article>

        <hr class="mt-3">

        <div class="comment-section">
            <h3>Bình Luận (<%= comments.length %>)</h3>
            <div class="comment-list mt-2">
                <% if (comments.length > 0) { %>
                    <% comments.forEach(c => { %>
                        <div class="comment-item">
                            <strong><%= c.author_name %></strong> 
                            <span style="font-size: 0.8rem; color:#888;"> - <%= new Date(c.created_at).toLocaleDateString('vi-VN') %></span>
                            <p class="mt-1"><%= c.content %></p>
                        </div>
                    <% }) %>
                <% } else { %>
                    <p>Chưa có bình luận nào. Hãy là người đầu tiên!</p>
                <% } %>
            </div>

            <h4 class="mt-3">Gửi bình luận của bạn</h4>
            <form action="/tin-tuc/comment" method="POST" class="mt-1">
                <input type="hidden" name="post_id" value="<%= post.id %>">
                <div style="margin-bottom: 15px;">
                    <input type="text" name="author_name" placeholder="Tên của bạn" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <textarea name="content" rows="4" placeholder="Nội dung bình luận..." required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px;"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Gửi Bình Luận</button>
            </form>
        </div>
    </div>

    <%- include('../partials/footer') %>
</body>
</html>