<!DOCTYPE html>
<html lang="vi">
<head>
    <%- include('../partials/head', { title: post.title + ' - Catfe' }) %>
    
    <style>
        /* Breadcrumb */
        .breadcrumb {
            padding: 20px 0;
            margin-bottom: 30px;
            font-size: 0.9rem;
            
            background: rgba(254, 250, 240, 0.25);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: inline-block;
            padding: 12px 24px;
        }
        
        .breadcrumb a {
            color: rgba(40, 54, 24, 0.85);
            font-weight: 600;
            text-decoration: none;
        }
        
        .breadcrumb span {
            color: rgba(40, 54, 24, 0.5);
            margin: 0 8px;
        }
        
        /* Article Container - Glass Card */
        article {
            padding: 40px;
            border-radius: 24px;
            margin-bottom: 50px;
            
            background: rgba(254, 250, 240, 0.35);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(40, 54, 24, 0.12),
                        inset 0 1px 0 0 rgba(255, 255, 255, 0.3);
        }
        
        article h1 {
            color: rgba(40, 54, 24, 0.95);
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 15px;
            line-height: 1.3;
        }
        
        /* Post Meta */
        .post-meta {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: rgba(163, 197, 151, 0.2);
            backdrop-filter: blur(8px);
            border-radius: 20px;
            color: rgba(40, 54, 24, 0.75);
            font-size: 0.9rem;
            margin-bottom: 30px;
        }
        
        /* Post Thumbnail */
        .post-thumbnail {
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(40, 54, 24, 0.2);
            margin-bottom: 30px;
        }
        
        .post-thumbnail img {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
            display: block;
        }
        
        /* Post Content */
        .post-content {
            font-size: 1.05rem;
            line-height: 1.8;
            color: rgba(40, 54, 24, 0.85);
        }
        
        .post-content p {
            margin-bottom: 20px;
        }
        
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 12px;
            margin: 25px 0;
            box-shadow: 0 4px 20px rgba(40, 54, 24, 0.15);
        }
        
        /* Divider */
        hr {
            border: none;
            height: 1px;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(40, 54, 24, 0.2) 50%,
                transparent 100%
            );
            margin: 50px 0;
        }
        
        /* Comment Section - Glass Card */
        .comment-section {
            padding: 40px;
            border-radius: 24px;
            
            background: rgba(254, 250, 240, 0.30);
            backdrop-filter: blur(14px);
            -webkit-backdrop-filter: blur(14px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(40, 54, 24, 0.12),
                        inset 0 1px 0 0 rgba(255, 255, 255, 0.3);
        }
        
        .comment-section h3 {
            color: rgba(40, 54, 24, 0.95);
            font-size: 1.5rem;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Comment Item */
        .comment-item {
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 15px;
            
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-left: 4px solid rgba(147, 102, 57, 0.6);
            box-shadow: 0 4px 15px rgba(40, 54, 24, 0.08);
            transition: all 0.3s;
        }
        
        .comment-item:hover {
            transform: translateX(5px);
            box-shadow: 0 6px 25px rgba(40, 54, 24, 0.15);
        }
        
        .comment-item strong {
            color: rgba(40, 54, 24, 0.95);
            font-size: 1rem;
        }
        
        .comment-date {
            font-size: 0.8rem;
            color: rgba(40, 54, 24, 0.5);
            margin-left: 10px;
        }
        
        .comment-item p {
            margin-top: 10px;
            color: rgba(40, 54, 24, 0.75);
            line-height: 1.6;
        }
        
        /* Comment Form */
        .comment-form {
            margin-top: 30px;
            padding: 30px;
            border-radius: 16px;
            background: rgba(163, 197, 151, 0.1);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(163, 197, 151, 0.2);
        }
        
        .comment-form h4 {
            color: rgba(40, 54, 24, 0.95);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        
        .comment-form .form-group {
            margin-bottom: 20px;
        }
        
        .comment-form input,
        .comment-form textarea {
            width: 100%;
            padding: 14px 18px;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Montserrat', sans-serif;
            
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: rgba(40, 54, 24, 0.95);
            
            transition: all 0.3s;
        }
        
        .comment-form input:focus,
        .comment-form textarea:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.7);
            border-color: rgba(163, 197, 151, 0.6);
            box-shadow: 0 0 0 4px rgba(163, 197, 151, 0.15),
                        inset 0 1px 0 0 rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .comment-form textarea {
            resize: vertical;
            min-height: 120px;
        }
        
        /* Empty Comment State */
        .no-comments {
            text-align: center;
            padding: 40px;
            color: rgba(40, 54, 24, 0.6);
        }
        
        .no-comments i {
            font-size: 3rem;
            color: rgba(40, 54, 24, 0.25);
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <!-- Page Loader -->
    <div class="page-loader">
        <div class="loader-spinner"></div>
    </div>

    <%- include('../partials/header') %>

    <div class="container section-padding">
        <!-- Breadcrumb -->
        <div class="breadcrumb">
            <a href="/"><i class="fas fa-home"></i> Trang chủ</a> 
            <span>›</span> 
            <a href="/tin-tuc">Tin tức</a> 
            <span>›</span> 
            <strong><%= post.title.substring(0, 30) %>...</strong>
        </div>

        <!-- Article Content -->
        <article>
            <!-- Title -->
            <h1><%= post.title %></h1>
            
            <!-- Meta -->
            <div class="post-meta">
                <i class="far fa-calendar-alt"></i> 
                Đăng ngày: <%= new Date(post.publish_date).toLocaleDateString('vi-VN') %>
            </div>

            <!-- Thumbnail -->
            <div class="post-thumbnail">
                <img src="<%= post.thumbnail_url %>" 
                     alt="<%= post.title %>" 
                     onerror="this.src='https://images.unsplash.com/photo-1497935586351-b67a49e012bf?w=1200&h=600&fit=crop'">
            </div>

            <!-- Content -->
            <div class="post-content">
                <%- post.content %>
            </div>
        </article>

        <hr>

        <!-- Comment Section -->
        <div class="comment-section">
            <h3>
                <i class="fas fa-comments"></i> 
                Bình Luận (<%= comments.length %>)
            </h3>
            
            <!-- Comment List -->
            <div class="comment-list">
                <% if (comments && comments.length > 0) { %>
                    <% comments.forEach(c => { %>
                        <div class="comment-item">
                            <div>
                                <strong><i class="fas fa-user-circle"></i> <%= c.author_name %></strong>
                                <span class="comment-date">
                                    <i class="far fa-clock"></i> 
                                    <%= new Date(c.created_at).toLocaleDateString('vi-VN') %>
                                </span>
                            </div>
                            <p><%= c.content %></p>
                        </div>
                    <% }) %>
                <% } else { %>
                    <div class="no-comments">
                        <i class="far fa-comment-dots"></i>
                        <p>Chưa có bình luận nào. Hãy là người đầu tiên chia sẻ ý kiến!</p>
                    </div>
                <% } %>
            </div>

            <!-- Comment Form -->
            <div class="comment-form">
                <h4><i class="fas fa-pen"></i> Gửi bình luận của bạn</h4>
                <form action="/tin-tuc/comment" method="POST">
                    <input type="hidden" name="post_id" value="<%= post.id %>">
                    
                    <div class="form-group">
                        <input type="text" 
                               name="author_name" 
                               placeholder="Tên của bạn *" 
                               required>
                    </div>
                    
                    <div class="form-group">
                        <textarea name="content" 
                                  rows="4" 
                                  placeholder="Nội dung bình luận... *" 
                                  required></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="padding: 12px 32px;">
                        <i class="fas fa-paper-plane"></i> Gửi Bình Luận
                    </button>
                </form>
            </div>
        </div>
    </div>

    <%- include('../partials/footer') %>
</body>
</html>