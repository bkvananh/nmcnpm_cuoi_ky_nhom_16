<!DOCTYPE html>
<html lang="vi">
<head>
    <%- include('../partials/head') %>
    
    <style>
        .swiper {
            width: 100%;
            height: 500px; /* Chiều cao banner trên Desktop */
        }
        
        .swiper-slide img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Đảm bảo ảnh full màn hình không bị méo */
        }

        /* Responsive cho Mobile */
        @media (max-width: 768px) {
            .swiper { height: 300px; }
        }

        /* Section Title Style */
        .section-title {
            text-align: center;
            margin-bottom: 40px;
            color: var(--primary);
            text-transform: uppercase;
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background-color: var(--secondary);
            margin: 10px auto 0;
        }

        /* Grid Tin tức (3 cột) */
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .news-card {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: var(--transition);
        }
        
        .news-card:hover { transform: translateY(-5px); }
        
        .news-img {
            height: 200px;
            width: 100%;
            object-fit: cover;
        }
        
        .news-body { padding: 20px; }
        .news-date { font-size: 0.8rem; color: #888; margin-bottom: 5px; }
        .news-title { font-size: 1.1rem; margin-bottom: 10px; }
        .news-excerpt { font-size: 0.9rem; color: var(--text); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    </style>
</head>
<body>

    <%- include('../partials/header') %>

    <div class="swiper mySwiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide">
                <img src="/img/banners/banner-1.jpg" alt="Banner Highlands 1" onerror="this.src='https://placehold.co/1200x500/283618/FFF?text=Banner+1'">
            </div>
            <div class="swiper-slide">
                <img src="/img/banners/banner-2.jpg" alt="Banner Highlands 2" onerror="this.src='https://placehold.co/1200x500/936639/FFF?text=Banner+2'">
            </div>
            <div class="swiper-slide">
                <img src="/img/banners/banner-3.jpg" alt="Banner Highlands 3" onerror="this.src='https://placehold.co/1200x500/582F0E/FFF?text=Banner+3'">
            </div>
        </div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-pagination"></div>
    </div>

    <section class="section-padding container">
        <h2 class="section-title">Món Ngon Phải Thử</h2>
        
        <div class="product-grid">
            <% if (featuredProducts.length > 0) { %>
                <% featuredProducts.forEach(function(item) { %>
                    <div class="product-card">
                        <div class="card-img-wrapper">
                            <img src="<%= item.image_url %>" alt="<%= item.name %>" onerror="this.src='/img/placeholder/product-default.jpg'">
                        </div>
                        <div class="card-body">
                            <h3 class="product-title"><%= item.name %></h3>
                            <p class="product-price"><%= item.price.toLocaleString('vi-VN') %> đ</p>
                            <a href="/thuc-don" class="btn btn-primary">Đặt Ngay</a>
                        </div>
                    </div>
                <% }); %>
            <% } else { %>
                <p class="text-center">Đang cập nhật món mới...</p>
            <% } %>
        </div>
        
        <div class="text-center mt-3">
            <a href="/thuc-don" class="btn btn-outline-primary" style="border: 1px solid var(--primary); padding: 10px 30px;">Xem Tất Cả Menu</a>
        </div>
    </section>

    <section class="section-padding" style="background-color: #f3eee6;">
        <div class="container">
            <h2 class="section-title">Tin Tức & Sự Kiện</h2>
            
            <div class="news-grid">
                <% if (recentPosts && recentPosts.length > 0) { %>
                    <% recentPosts.forEach(function(post) { %>
                        <div class="news-card">
                            <a href="/tin-tuc/<%= post.id %>">
                                <img src="<%= post.thumbnail_url %>" alt="<%= post.title %>" class="news-img" onerror="this.src='/img/placeholder/post-default.jpg'">
                            </a>
                            <div class="news-body">
                                <div class="news-date">
                                    <i class="far fa-calendar-alt"></i> 
                                    <%= new Date(post.publish_date).toLocaleDateString('vi-VN') %>
                                </div>
                                <h3 class="news-title">
                                    <a href="/tin-tuc/<%= post.id %>"><%= post.title %></a>
                                </h3>
                                <div class="news-excerpt">
                                    Click để xem chi tiết bài viết...
                                </div>
                            </div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <p class="text-center">Chưa có tin tức nào.</p>
                <% } %>
            </div>
        </div>
    </section>

    <%- include('../partials/footer') %>

    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script>
        // Khởi tạo Slider
        var swiper = new Swiper(".mySwiper", {
            spaceBetween: 30,
            centeredSlides: true,
            autoplay: {
                delay: 3500, // Tự chạy sau 3.5s
                disableOnInteraction: false,
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
            loop: true
        });
    </script>
</body>
</html>